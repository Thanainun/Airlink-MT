$(function(){function l(a,c,d){$(a).position({of:$("#parent_image"),my:"left top",at:"left top",offset:c+" "+d,collision:"flip flip"})}function w(a,c,d){var h=[a.toString(16),c.toString(16),d.toString(16)];$.each(h,function(a,c){c.length===1&&(h[a]="0"+c)});return h.join("").toUpperCase()}function q(a,c,d,h){var m=[],e=a.html();a.css("font-weight","");a.css("text-decoration","");if(c=="B"||c=="BI"||c=="BU"||c=="BIU")a.css("font-weight","bold"),m[0]="checked";c=="I"||c=="IU"||c=="BI"||c=="BIU"?(e.substr(0,4)!="<em>"&&a.html("<em>"+e+"</em>"),m[1]="checked"):e.substr(0,4)=="<em>"&&a.html(a.find("em").html());if(c=="U"||c=="IU"||c=="BU"||c=="BIU")a.css("text-decoration","underline"),m[2]="checked";a.css("font-size",d);a.css("font-family",h);return m}function x(){$(".positionable").each(function(a,c){var d=$(c).find("input[id=x]"),h=$(c).find("input[id=y]"),e=$(c).find("input[id=font_color_r]").val(),f=$(c).find("input[id=font_color_g]").val(),i=$(c).find("input[id=font_color_b]").val(),k=$(c).find("input[id=font_style]").val(),j=$(c).find("input[id=font_size]").val(),n=$(c).find("input[id=font_name]").val();j++;j--;var o=$(c).find("div#example_text");q(o,k,j,n);o.css("color","rgb("+e+","+f+","+i+")");l(c,d.val(),h.val())})}function y(){var a=(e.width()-f.width())/e.width(),a=f.width()-a*f.width();i.find(".ui-slider-handle").css({width:a,"margin-left":-a/2});z.width("").width(i.width()-a)}function A(){var a=$("#paper_page").val(),c=$("form#form a.go_example").attr("href"),c=c.replace(/.\/?html/ig,""),c=c.replace(/\/\/?2x4/ig,""),c=c.replace(/\/\/?3x7/ig,"");a==1?($("img#example_pdf").attr("src",base_url+ASSETS+"images/2x4.jpg"),$("form#form a.go_example").attr("href",c+"/2x4")):($("img#example_pdf").attr("src",base_url+ASSETS+"images/3x7.jpg"),$("form#form a.go_example").attr("href",c+"/3x7"))}var k=$("div#parent_image");$(".positionable, input#text_msg").css("background","transparent");k.live("hover click",function(){k.find(".positionable, input#text_msg").attr("autocomplete","off");$("div.positionable").draggable({containment:"#parent_image",handle:"div#example_text",grid:[2,2],scroll:!1,stack:"#parent_image div",drag:function(a,c){var d=$(this).find("input[id=x]"),h=$(this).find("input[id=y]");d.val("0");h.val("0");d.val();h.val();$(this).position({of:$("#parent_image"),my:"left top",at:"left top",offset:d.val()+" "+h.val(),using:function(a){$("#moniter").html("Position X:"+(c.offset.left-a.left)+", Y:"+(c.offset.top-a.top));d.val(c.offset.left-a.left);h.val(c.offset.top-a.top)},collision:"flip flip"})}})});k.hover(function(){$(".positionable, input#text_msg").css("background-color","#EAEAEA").css("opacity",0.8)},function(){$(".positionable, input#text_msg").css("background","transparent")});$("#addnew").click(function(){var a=0;$("div.positionable").each(function(){$(this).is("#static")||a++});$('<div class="positionable" id="custom_'+a+'" style="left: -1000px; top: 0px;"><span id="text_tool" class="ui-icon ui-icon-circle-triangle-e"></span><div title="\u0e14\u0e31\u0e1a\u0e40\u0e1a\u0e34\u0e49\u0e25\u0e04\u0e25\u0e34\u0e01 \u0e41\u0e01\u0e49\u0e44\u0e02" id="example_text" style="font-size:10px; font-family: AngsanaNew;">Double click to edit</div><input type="text" class="hidden" value="Double click to edit" id="text_msg" name="custom_msg_'+a+'" size="15"/><input type="hidden" id="x" class="in" value="20" name="custom_x_'+a+'"/><input type="hidden" id="y" class="in" value="1" name="custom_y_'+a+'"/><input type="hidden" id="font_color_r" value="0" name="custom_font_color_r_'+a+'"/><input type="hidden" id="font_color_g" value="0" name="custom_font_color_g_'+a+'"/><input type="hidden" id="font_color_b" value="0" name="custom_font_color_b_'+a+'"/><input type="hidden" id="font_style" value="" name="custom_font_style_'+a+'"/><input type="hidden" id="font_size" value="10" name="custom_font_size_'+a+'"/><input type="hidden" id="font_name" value="AngsanaNew" name="custom_font_name_'+a+'"/></div>').appendTo("#parent_image").css("background-color","#EAEAEA").css("opacity",0.8);l("#custom_"+a,"20","1");a++});$("div#example_text").live("dblclick",function(){var a=$(this),c=a.parents("div.positionable"),d=c.find("input[id=text_msg]");d.slideDown();d.bind("keydown keyup mousedown",function(){$(a).html(d.val())}).focus().blur(function(){d.slideUp("slow",function(){d.val()==""&&c.remove();var a=0;$("div.positionable").each(function(){$(this).is("#static")||($(this).find("input#text_msg").attr("name","custom_msg_"+a),$(this).find("input#x").attr("name","custom_x_"+a),$(this).find("input#y").attr("name","custom_y_"+a),$(this).find("input#font_color_r").attr("name","custom_font_color_r_"+a),$(this).find("input#font_color_g").attr("name","custom_font_color_g_"+a),$(this).find("input#font_color_b").attr("name","custom_font_color_b_"+a),$(this).find("input#font_style").attr("name","custom_font_style_"+a),$(this).find("input#font_size").attr("name","custom_font_size_"+a),$(this).find("input#font_name").attr("name","custom_font_name_"+a),a++)})})})});x();$(window).resize(function(){x()});$("div.scroll-pane .scroll-content img").click(function(){var a=$(this).attr("src"),c=$(this).attr("id");$("img#card_bg").fadeTo("slow",0.1,function(){$("img#card_bg").attr("src",a);$("input#image_input").val(c)}).fadeTo("slow",1)});$("span.ui-icon-circle-triangle-e").live("click",function(){var a=new Date,a=a.getTime(),c=$(this),d=c.parents("div.positionable"),e=d.find("div#example_text"),f=d.find("input[id=font_color_r]"),i=d.find("input[id=font_color_g]"),k=d.find("input[id=font_color_b]"),l=d.find("input[id=text_msg]"),j=d.find("input[id=font_size]"),n=d.find("input[id=font_style]"),o=d.find("input[id=font_name]"),p=d.find("div#example_text"),s=q(p,n.val());$(this).removeClass("ui-icon-circle-triangle-e");$(this).addClass("ui-icon-circle-triangle-w");$('<div id="tool_box" title="'+l.val().substr(0,10)+'..."><span id="tool"></span></div>').appendTo(d);$(d).find("span#tool").after('<table width="100%"><tr><td width="30%" align="right">Format:</td><td><div id="'+a+'"><input type="checkbox" value="B" id="check1'+a+'" '+s[0]+' class="'+a+'" /><label for="check1'+a+'">B</label><input type="checkbox" value="I" id="check2'+a+'" '+s[1]+' class="'+a+'" /><label for="check2'+a+'">I</label><input type="checkbox" value="U" id="check3'+a+'" '+s[2]+' class="'+a+'" /><label for="check3'+a+'">U</label></div></td></tr><tr><td align="right">Font:</td><td>'+select_fonts()+'</td></tr><tr><td align="right">Size:</td><td><input type="number" value="'+j.val()+'" style="width: 89px; font-size: 10px;" /></td></tr></table>').after('<div style="border:0; margin-top:10px;" class="ui-widget-content"><div id="red"></div><div id="green"></div><div id="blue"></div></div>');var t=d.find("div#red"),u=d.find("div#green"),v=d.find("div#blue");d.find("div#red, div#green, div#blue").slider({orientation:"horizontal",range:"min",max:255,value:0,slide:function(){var a=t.slider("value"),c=u.slider("value"),d=v.slider("value"),a=w(a,c,d);e.css("color","#"+a)},change:function(){var a=t.slider("value"),c=u.slider("value"),d=v.slider("value"),j=w(a,c,d);e.css("color","#"+j);f.val(a);i.val(c);k.val(d)}});r=f.val();g=i.val();b=k.val();t.slider("value",r);u.slider("value",g);v.slider("value",b);d.find("div#"+a).buttonset();d.find("input."+a).change(function(){var c="";$(this).parents("div#"+a).find("input[type=checkbox]:checked").each(function(a,d){c+=$(d).val()});n.val(c);q(p,c)});d.find("select#fonts_select").bind("change keyup",function(){o.val($(this).val());p.css("font-family",$(this).val())});d.find("input[type=number]").bind("keyup mouseup mouseout",function(){var a=$(this).val();a++;a--;j.val(a);p.css("font-size",a)});d.find("div#tool_box").dialog({autoOpen:!0,height:210,width:170,modal:!1,resizable:!1,close:function(){$(this).remove();c.removeClass("ui-icon-circle-triangle-w");c.addClass("ui-icon-circle-triangle-e")}})});var f=$(".scroll-pane"),e=$(".scroll-content"),i=$(".scroll-bar").slider({slide:function(a,c){e.width()>f.width()?e.css("margin-left",Math.round(c.value/100*(f.width()-e.width()))+"px"):e.css("margin-left",0)}}),z=i.find(".ui-slider-handle").mousedown(function(){i.width(z.width())}).mouseup(function(){i.width("100%")}).append("<span class='ui-icon ui-icon-grip-dotted-vertical'></span>").wrap("<div class='ui-handle-helper-parent'></div>").parent();f.css("overflow","hidden");$(window).resize(function(){var a=f.width()-e.width(),c=e.css("margin-left")==="auto"?0:parseInt(e.css("margin-left"));i.slider("value",Math.round(c/a*100));y();a=e.width()+parseInt(e.css("margin-left"),10);a=f.width()-a;a>0&&e.css("margin-left",parseInt(e.css("margin-left"),10)+a)});setTimeout(y,10);$("#paper_page").change(function(){A()});A();$(".go_example").click(function(){var a=$("form#form a.go_example").attr("href");window.open(a,"_blank","width=800,height=600,scrollbars=yes,status=yes,resizable=yes,screenx=0,screeny=0");return!1})});